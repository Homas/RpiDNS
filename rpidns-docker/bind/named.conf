// RpiDNS Bind Configuration
// This is a minimal default configuration
// User-specific configuration will be mounted at runtime

// Include rndc key for remote control
include "/etc/bind/rndc.key";

// Controls for rndc
controls {
    inet 127.0.0.1 port 953 allow { 127.0.0.1; } keys { "rndc-key"; };
};

options {
    directory "/var/cache/bind";
    
    // Listen on all interfaces
    listen-on { any; };
    listen-on-v6 { any; };
    
    // Allow queries from any source (configure ACL as needed)
    allow-query { any; };
    
    // Disable recursion by default for security
    // Enable in user-specific config if needed
    recursion yes;
    
    // DNSSEC validation
    dnssec-validation auto;
    
    // Reduce logging verbosity
    minimal-responses yes;
    
    // PID file location
    pid-file "/var/run/named/named.pid";
};

// Logging configuration
logging {
    channel default_log {
        file "/opt/rpidns/logs/bind.log" versions 3 size 5m;
        severity info;
        print-time yes;
        print-severity yes;
        print-category yes;
    };
    
    channel query_log {
        file "/opt/rpidns/logs/bind_queries.log" versions 3 size 10m;
        severity info;
        print-time yes;
    };
    
    category default { default_log; };
    category queries { query_log; };
};

// Root hints (Alpine Linux path)
zone "." {
    type hint;
    file "/var/bind/root.cache";
};

// Localhost zones
zone "localhost" {
    type master;
    file "/etc/bind/db.empty.pi";
};

zone "127.in-addr.arpa" {
    type master;
    file "/etc/bind/db.empty.pi";
};
